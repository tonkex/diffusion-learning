<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>í™•ì‚°ëª¨ë¸ í•™ìŠµ â€” ë°‘ë°”ë‹¥ë¶€í„° ì‹œì‘í•˜ëŠ” ë”¥ëŸ¬ë‹ 5</title>
<script>
MathJax = {
  tex: { inlineMath: [['$','$']], displayMath: [['$$','$$']], tags: 'ams' },
  options: { skipHtmlTags: ['script','noscript','style','textarea'] }
};
</script>
<script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4/dist/chart.umd.min.js"></script>
<style>
/* ===== RESET & BASE ===== */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { font-size: 16px; }
body {
  font-family: 'Segoe UI', 'Apple SD Gothic Neo', sans-serif;
  background: #f0f4f8;
  color: #1e293b;
  display: flex;
  height: 100vh;
  overflow: hidden;
}

/* ===== SIDEBAR ===== */
#sidebar {
  width: 280px;
  min-width: 240px;
  background: #0f172a;
  color: #cbd5e1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  flex-shrink: 0;
  box-shadow: 4px 0 20px rgba(0,0,0,0.4);
  z-index: 10;
}
#sidebar-header {
  padding: 20px 18px 16px;
  background: #020617;
  border-bottom: 1px solid #1e293b;
}
#sidebar-header .brand {
  font-size: 0.72rem;
  color: #64748b;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  margin-bottom: 6px;
}
#sidebar-header h1 {
  font-size: 1.05rem;
  color: #f1f5f9;
  font-weight: 700;
  line-height: 1.4;
}
#sidebar-header .subtitle {
  font-size: 0.75rem;
  color: #94a3b8;
  margin-top: 4px;
}
#nav {
  overflow-y: auto;
  flex: 1;
  padding: 10px 0;
}
#nav::-webkit-scrollbar { width: 4px; }
#nav::-webkit-scrollbar-thumb { background: #334155; border-radius: 2px; }

.ch-block { border-bottom: 1px solid #1e293b; }
.ch-toggle {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 11px 18px;
  cursor: pointer;
  font-size: 0.82rem;
  font-weight: 600;
  color: #94a3b8;
  user-select: none;
  transition: background 0.15s, color 0.15s;
}
.ch-toggle:hover { background: #1e293b; color: #e2e8f0; }
.ch-toggle.open { color: #e2e8f0; }
.ch-num {
  background: #1e3a5f;
  color: #60a5fa;
  border-radius: 4px;
  padding: 2px 7px;
  font-size: 0.72rem;
  font-weight: 700;
  flex-shrink: 0;
}
.ch-toggle.open .ch-num { background: #1d4ed8; color: #bfdbfe; }
.ch-arrow {
  margin-left: auto;
  transition: transform 0.2s;
  font-size: 0.65rem;
  color: #475569;
}
.ch-toggle.open .ch-arrow { transform: rotate(180deg); }

.ch-subs { display: none; }
.ch-subs.open { display: block; }

.sub-item {
  padding: 8px 18px 8px 42px;
  font-size: 0.78rem;
  color: #64748b;
  cursor: pointer;
  position: relative;
  transition: background 0.12s, color 0.12s;
  line-height: 1.4;
}
.sub-item:hover { background: #1e293b; color: #cbd5e1; }
.sub-item.active {
  background: #1d4ed8;
  color: #fff;
  font-weight: 600;
}
.sub-item::before {
  content: '';
  position: absolute;
  left: 26px;
  top: 50%;
  width: 5px;
  height: 5px;
  border-radius: 50%;
  background: #334155;
  transform: translateY(-50%);
}
.sub-item.active::before { background: #93c5fd; }
.sub-item.placeholder { color: #334155; cursor: default; font-style: italic; }
.sub-item.placeholder:hover { background: none; }

/* ===== MAIN CONTENT ===== */
#main {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}
#topbar {
  background: #fff;
  border-bottom: 1px solid #e2e8f0;
  padding: 12px 28px;
  display: flex;
  align-items: center;
  gap: 10px;
  flex-shrink: 0;
}
#breadcrumb { font-size: 0.8rem; color: #64748b; }
#breadcrumb span { color: #3b82f6; font-weight: 600; }
#content-area {
  flex: 1;
  overflow-y: auto;
  padding: 32px 36px;
}
#content-area::-webkit-scrollbar { width: 6px; }
#content-area::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }

/* ===== CONTENT COMPONENTS ===== */
.page-title {
  font-size: 1.8rem;
  font-weight: 800;
  color: #0f172a;
  margin-bottom: 6px;
  padding-bottom: 14px;
  border-bottom: 3px solid #3b82f6;
}
.page-subtitle {
  color: #64748b;
  font-size: 0.95rem;
  margin-bottom: 28px;
}
.section {
  background: #fff;
  border-radius: 12px;
  padding: 24px 28px;
  margin-bottom: 20px;
  box-shadow: 0 1px 6px rgba(0,0,0,0.07);
  border: 1px solid #e2e8f0;
}
.section-title {
  font-size: 1.15rem;
  font-weight: 700;
  color: #1d4ed8;
  margin-bottom: 14px;
  display: flex;
  align-items: center;
  gap: 8px;
}
.section-title .icon { font-size: 1.1rem; }
.section p { line-height: 1.8; color: #374151; margin-bottom: 10px; }
.section p:last-child { margin-bottom: 0; }

.highlight-box {
  background: #eff6ff;
  border-left: 4px solid #3b82f6;
  border-radius: 0 8px 8px 0;
  padding: 14px 18px;
  margin: 14px 0;
  font-size: 0.92rem;
  color: #1e40af;
}
.highlight-box.green {
  background: #f0fdf4;
  border-color: #22c55e;
  color: #166534;
}
.highlight-box.amber {
  background: #fffbeb;
  border-color: #f59e0b;
  color: #92400e;
}
.highlight-box.purple {
  background: #faf5ff;
  border-color: #8b5cf6;
  color: #4c1d95;
}
.math-block {
  background: #f8fafc;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  padding: 16px 20px;
  margin: 14px 0;
  text-align: center;
  font-size: 1.05rem;
  overflow-x: auto;
}
.formula-label {
  font-size: 0.75rem;
  color: #94a3b8;
  text-align: right;
  margin-top: 4px;
}
ul.content-list, ol.content-list {
  padding-left: 22px;
  margin: 10px 0;
}
ul.content-list li, ol.content-list li {
  margin-bottom: 8px;
  line-height: 1.7;
  color: #374151;
}
.tag {
  display: inline-block;
  background: #dbeafe;
  color: #1d4ed8;
  padding: 2px 9px;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 600;
}
.tag.green { background: #dcfce7; color: #166534; }
.tag.purple { background: #ede9fe; color: #4c1d95; }

/* ===== INTERACTIVE PANELS ===== */
.interactive-panel {
  background: #f8fafc;
  border: 1px solid #e2e8f0;
  border-radius: 10px;
  margin-top: 18px;
  overflow: hidden;
}
.panel-header {
  background: #1e3a5f;
  color: #bfdbfe;
  padding: 10px 18px;
  font-size: 0.82rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
}
.panel-body {
  padding: 18px;
  display: flex;
  gap: 18px;
  flex-wrap: wrap;
}
.chart-wrap {
  flex: 1;
  min-width: 260px;
}
.chart-wrap canvas { width: 100% !important; }
.controls-wrap {
  width: 220px;
  flex-shrink: 0;
}
.ctrl-group {
  margin-bottom: 16px;
}
.ctrl-label {
  font-size: 0.78rem;
  color: #64748b;
  margin-bottom: 6px;
  font-weight: 600;
}
.ctrl-row {
  display: flex;
  align-items: center;
  gap: 8px;
}
input[type=range] {
  flex: 1;
  height: 4px;
  accent-color: #3b82f6;
  cursor: pointer;
}
.val-badge {
  background: #dbeafe;
  color: #1e40af;
  padding: 2px 10px;
  border-radius: 6px;
  font-size: 0.8rem;
  font-weight: 700;
  min-width: 52px;
  text-align: center;
}
.btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 18px;
  border: none;
  border-radius: 8px;
  font-size: 0.83rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.15s, transform 0.1s;
}
.btn:active { transform: scale(0.97); }
.btn-primary { background: #3b82f6; color: #fff; }
.btn-primary:hover { background: #2563eb; }
.btn-secondary { background: #e2e8f0; color: #374151; }
.btn-secondary:hover { background: #cbd5e1; }
.btn-green { background: #22c55e; color: #fff; }
.btn-green:hover { background: #16a34a; }

.stat-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 10px;
  margin-top: 10px;
}
.stat-card {
  background: #fff;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  padding: 12px;
  text-align: center;
}
.stat-card .label { font-size: 0.72rem; color: #94a3b8; margin-bottom: 4px; }
.stat-card .value { font-size: 1.2rem; font-weight: 700; color: #1e293b; }

/* Probability table */
.prob-table {
  border-collapse: collapse;
  width: 100%;
  font-size: 0.85rem;
  margin: 12px 0;
}
.prob-table th {
  background: #1e3a5f;
  color: #bfdbfe;
  padding: 8px 14px;
  text-align: center;
}
.prob-table td {
  border: 1px solid #e2e8f0;
  padding: 7px 14px;
  text-align: center;
  color: #374151;
}
.prob-table tr:nth-child(even) td { background: #f8fafc; }

/* Dice simulator */
.dice-grid {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin: 10px 0;
}
.die {
  width: 48px;
  height: 48px;
  background: #fff;
  border: 2px solid #3b82f6;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.4rem;
  font-weight: 800;
  color: #1d4ed8;
  transition: transform 0.2s;
}
.die.rolling { animation: roll 0.3s ease; }
@keyframes roll {
  0% { transform: rotate(-15deg) scale(0.9); }
  50% { transform: rotate(10deg) scale(1.05); }
  100% { transform: rotate(0deg) scale(1); }
}

/* Step indicator */
.steps {
  display: flex;
  gap: 0;
  margin: 20px 0;
  overflow-x: auto;
}
.step {
  flex: 1;
  min-width: 100px;
  text-align: center;
  padding: 10px 6px;
  position: relative;
  font-size: 0.75rem;
  color: #94a3b8;
}
.step::after {
  content: 'â†’';
  position: absolute;
  right: -8px;
  top: 50%;
  transform: translateY(-50%);
  color: #cbd5e1;
}
.step:last-child::after { display: none; }
.step-num {
  width: 30px;
  height: 30px;
  border-radius: 50%;
  background: #e2e8f0;
  color: #64748b;
  font-weight: 700;
  font-size: 0.8rem;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 6px;
}
.step.active .step-num { background: #3b82f6; color: #fff; }
.step.active { color: #1e293b; font-weight: 600; }

/* Chapter link */
.ch-link {
  display: inline-flex;
  align-items: center;
  gap: 5px;
  color: #3b82f6;
  text-decoration: none;
  font-size: 0.83rem;
  font-weight: 600;
  padding: 3px 8px;
  border-radius: 6px;
  transition: background 0.12s;
}
.ch-link:hover { background: #dbeafe; }

/* Welcome screen */
.welcome {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  text-align: center;
  color: #64748b;
}
.welcome h2 { font-size: 2rem; color: #1e293b; margin-bottom: 12px; }
.welcome p { font-size: 1rem; margin-bottom: 30px; max-width: 480px; }
.chapter-cards {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 14px;
  width: 100%;
  max-width: 720px;
}
.chapter-card {
  background: #fff;
  border: 1px solid #e2e8f0;
  border-radius: 10px;
  padding: 16px;
  cursor: pointer;
  transition: border-color 0.15s, box-shadow 0.15s;
  text-align: left;
}
.chapter-card:hover {
  border-color: #3b82f6;
  box-shadow: 0 4px 16px rgba(59,130,246,0.15);
}
.chapter-card .num { font-size: 0.72rem; color: #94a3b8; margin-bottom: 6px; }
.chapter-card .title { font-size: 0.88rem; font-weight: 700; color: #1e293b; }
.chapter-card .badge {
  font-size: 0.68rem;
  background: #dbeafe;
  color: #1d4ed8;
  padding: 2px 8px;
  border-radius: 8px;
  display: inline-block;
  margin-top: 8px;
}
.chapter-card .badge.soon { background: #f1f5f9; color: #94a3b8; }

/* ===== PAGE NAVIGATION ===== */
.page-nav {
  display: flex;
  align-items: stretch;
  justify-content: space-between;
  margin-top: 32px;
  padding-top: 20px;
  border-top: 2px solid #e2e8f0;
  gap: 10px;
}
.nav-btn {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 12px 18px;
  border: 1.5px solid #e2e8f0;
  border-radius: 10px;
  background: #fff;
  cursor: pointer;
  transition: border-color 0.15s, box-shadow 0.15s, background 0.15s;
  font-family: inherit;
  text-align: left;
  min-width: 160px;
  max-width: 260px;
}
.nav-btn:hover {
  border-color: #3b82f6;
  box-shadow: 0 2px 10px rgba(59,130,246,0.15);
  background: #f8faff;
}
.nav-btn-prev { flex-direction: row; }
.nav-btn-next { flex-direction: row-reverse; text-align: right; }
.nav-arrow { font-size: 1.1rem; color: #94a3b8; flex-shrink: 0; transition: color 0.15s; }
.nav-btn:hover .nav-arrow { color: #3b82f6; }
.nav-info { flex: 1; min-width: 0; }
.nav-label { font-size: 0.7rem; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.06em; font-weight: 600; margin-bottom: 3px; }
.nav-title { font-size: 0.85rem; font-weight: 700; color: #1e293b; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.nav-btn-home {
  flex-direction: column;
  justify-content: center;
  align-items: center;
  min-width: 110px;
  max-width: 130px;
  flex: 0 0 auto;
  gap: 4px;
  background: #f8fafc;
}
.nav-btn-home:hover { border-color: #8b5cf6; background: #faf5ff; box-shadow: 0 2px 10px rgba(139,92,246,0.15); }
.nav-home-icon { font-size: 1.3rem; }
.nav-home-label { font-size: 0.75rem; font-weight: 600; color: #64748b; }
.nav-spacer { min-width: 160px; max-width: 260px; visibility: hidden; }

/* Responsive */
@media (max-width: 768px) {
  #sidebar { width: 220px; }
  #content-area { padding: 20px 16px; }
  .panel-body { flex-direction: column; }
  .controls-wrap { width: 100%; }
}
</style>
</head>
<body>

<!-- SIDEBAR -->
<aside id="sidebar">
  <div id="sidebar-header">
    <div class="brand">ë°‘ë°”ë‹¥ë¶€í„° ì‹œì‘í•˜ëŠ” ë”¥ëŸ¬ë‹ 5</div>
    <h1>í™•ì‚°ëª¨ë¸ í•™ìŠµ</h1>
    <div class="subtitle">Deep Learning From Scratch 5</div>
  </div>
  <nav id="nav"></nav>
</aside>

<!-- MAIN -->
<div id="main">
  <div id="topbar">
    <div id="breadcrumb">ì±•í„°ë¥¼ ì„ íƒí•´ í•™ìŠµì„ ì‹œì‘í•˜ì„¸ìš”</div>
  </div>
  <div id="content-area">
    <div class="welcome" id="welcome-screen">
      <h2>ğŸ“ í™•ì‚°ëª¨ë¸ í•™ìŠµ</h2>
      <p>ì™¼ìª½ ë©”ë‰´ì—ì„œ ì±•í„°ë¥¼ ì„ íƒí•˜ë©´ í•™ìŠµ ë‚´ìš©ì´ í‘œì‹œë©ë‹ˆë‹¤.<br>
         ìˆ˜ì‹, ì¸í„°ë ‰í‹°ë¸Œ ì‹œë®¬ë ˆì´ì…˜, ì½”ë“œ ì˜ˆì‹œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
      <div class="chapter-cards" id="chapter-cards"></div>
    </div>
  </div>
</div>

<script>
/* ============================================================
   NAV DATA
   ============================================================ */
const NAV = [
  { id:1, title:'ì •ê·œë¶„í¬', subs:[
      { id:'1.1', title:'1.1 í™•ë¥ ì˜ ê¸°ì´ˆ', sections:[
          { id:'1.1.1', title:'í™•ë¥  ë³€ìˆ˜ì™€ í™•ë¥  ë¶„í¬' },
          { id:'1.1.2', title:'í™•ë¥  ë¶„í¬ì˜ ì¢…ë¥˜' },
          { id:'1.1.3', title:'ê¸°ëŒ€ê°’ê³¼ ë¶„ì‚°' },
      ]},
      { id:'1.2', title:'1.2 ì •ê·œ ë¶„í¬', sections:[
          { id:'1.2.1', title:'í™•ë¥  ë°€ë„ í•¨ìˆ˜' },
          { id:'1.2.2', title:'ì •ê·œ ë¶„í¬ ì‹œê°í™”' },
          { id:'1.2.3', title:'ë§¤ê°œë³€ìˆ˜ì˜ ì—­í• ' },
      ]},
      { id:'1.3', title:'1.3 ì¤‘ì‹¬ ê·¹í•œ ì •ë¦¬', sections:[
          { id:'1.3.1', title:'ì¤‘ì‹¬ ê·¹í•œ ì •ë¦¬ë€?' },
          { id:'1.3.2', title:'CLT ì‹œë®¬ë ˆì´ì…˜' },
      ]},
      { id:'1.4', title:'1.4 í‘œë³¸ í•©ì˜ ë¶„í¬', sections:[
          { id:'1.4.1', title:'ê¸°ëŒ€ê°’ê³¼ ë¶„ì‚°' },
          { id:'1.4.2', title:'í‘œë³¸ í•© ì‹œë®¬ë ˆì´ì…˜' },
          { id:'1.4.3', title:'ê· ë“± ë¶„í¬ì˜ í†µê³„ëŸ‰' },
      ]},
      { id:'1.5', title:'1.5 ìš°ë¦¬ ì£¼ë³€ì˜ ì •ê·œ ë¶„í¬', sections:[
          { id:'1.5.1', title:'ì¸¡ì • ì˜¤ì°¨Â·ì œí’ˆÂ·í‚¤' },
      ]},
  ]},
  { id:2, title:'ìµœëŒ€ ê°€ëŠ¥ë„ ì¶”ì •',   subs:[] },
  { id:3, title:'ë‹¤ë³€ëŸ‰ ì •ê·œ ë¶„í¬',   subs:[] },
  { id:4, title:'ê°€ìš°ìŠ¤ í˜¼í•© ëª¨ë¸',   subs:[] },
  { id:5, title:'EM ì•Œê³ ë¦¬ì¦˜',        subs:[] },
  { id:6, title:'ì‹ ê²½ë§',             subs:[] },
  { id:7, title:'ë³€ì´í˜• ì˜¤í† ì¸ì½”ë”',  subs:[] },
  { id:8, title:'í™•ì‚°ëª¨ë¸ ì´ë¡ ',      subs:[] },
  { id:9, title:'í™•ì‚°ëª¨ë¸ êµ¬í˜„',      subs:[] },
  { id:10,title:'í™•ì‚°ëª¨ë¸ ì‘ìš©',      subs:[] },
];

/* ============================================================
   FLAT SECTION LIST (for prev/next navigation)
   ============================================================ */
const FLAT_SECTIONS = [];
NAV.forEach(ch => {
  ch.subs.forEach(sub => {
    sub.sections.forEach(sec => {
      FLAT_SECTIONS.push({ id: sec.id, ch, sub, sec });
    });
  });
});

/* ============================================================
   BUILD SIDEBAR
   ============================================================ */
const nav = document.getElementById('nav');
const cards = document.getElementById('chapter-cards');

NAV.forEach(ch => {
  const hasContent = ch.subs.length > 0;
  // card on welcome
  const card = document.createElement('div');
  card.className = 'chapter-card';
  card.innerHTML = `<div class="num">Chapter ${ch.id}</div>
    <div class="title">${ch.title}</div>
    <div class="badge${hasContent ? '' : ' soon'}">${hasContent ? 'í•™ìŠµ ê°€ëŠ¥' : 'ì¤€ë¹„ì¤‘'}</div>`;
  if (hasContent) card.onclick = () => { toggleChapter(ch.id, true); };
  cards.appendChild(card);

  // sidebar block
  const block = document.createElement('div');
  block.className = 'ch-block';
  block.id = `ch-block-${ch.id}`;

  const toggle = document.createElement('div');
  toggle.className = 'ch-toggle';
  toggle.id = `ch-toggle-${ch.id}`;
  toggle.innerHTML = `<span class="ch-num">${ch.id}</span>
    <span>${ch.title}</span>
    <span class="ch-arrow">â–¼</span>`;
  if (hasContent) toggle.onclick = () => toggleChapter(ch.id);
  else toggle.style.opacity = '0.4';

  const subsDiv = document.createElement('div');
  subsDiv.className = 'ch-subs';
  subsDiv.id = `ch-subs-${ch.id}`;

  ch.subs.forEach(sub => {
    // sub-header (non-clickable label)
    const subLabel = document.createElement('div');
    subLabel.className = 'sub-item placeholder';
    subLabel.style.cssText = 'padding-left:18px;color:#475569;font-weight:700;font-size:0.76rem;cursor:default;';
    subLabel.textContent = sub.title;
    subsDiv.appendChild(subLabel);

    sub.sections.forEach(sec => {
      const item = document.createElement('div');
      item.className = 'sub-item';
      item.id = `nav-${sec.id}`;
      item.textContent = sec.title;
      item.onclick = () => loadSection(sec.id, ch, sub, sec);
      subsDiv.appendChild(item);
    });
  });

  block.appendChild(toggle);
  block.appendChild(subsDiv);
  nav.appendChild(block);
});

function toggleChapter(id, open=null) {
  const toggle = document.getElementById(`ch-toggle-${id}`);
  const subs   = document.getElementById(`ch-subs-${id}`);
  const isOpen = toggle.classList.contains('open');
  const shouldOpen = open !== null ? open : !isOpen;
  toggle.classList.toggle('open', shouldOpen);
  subs.classList.toggle('open', shouldOpen);
}

/* ============================================================
   PAGE NAVIGATION BAR
   ============================================================ */
function buildPageNav(currentId) {
  const idx  = FLAT_SECTIONS.findIndex(s => s.id === currentId);
  const prev = idx > 0                        ? FLAT_SECTIONS[idx - 1] : null;
  const next = idx < FLAT_SECTIONS.length - 1 ? FLAT_SECTIONS[idx + 1] : null;

  const prevBtn = prev
    ? `<button class="nav-btn nav-btn-prev"
         onclick="loadSection('${prev.id}',FLAT_SECTIONS[${idx-1}].ch,FLAT_SECTIONS[${idx-1}].sub,FLAT_SECTIONS[${idx-1}].sec)">
         <span class="nav-arrow">â—€</span>
         <div class="nav-info">
           <div class="nav-label">ì´ì „ í˜ì´ì§€</div>
           <div class="nav-title">${prev.sec.title}</div>
         </div>
       </button>`
    : `<div class="nav-spacer"></div>`;

  const nextBtn = next
    ? `<button class="nav-btn nav-btn-next"
         onclick="loadSection('${next.id}',FLAT_SECTIONS[${idx+1}].ch,FLAT_SECTIONS[${idx+1}].sub,FLAT_SECTIONS[${idx+1}].sec)">
         <div class="nav-info">
           <div class="nav-label">ë‹¤ìŒ í˜ì´ì§€</div>
           <div class="nav-title">${next.sec.title}</div>
         </div>
         <span class="nav-arrow">â–¶</span>
       </button>`
    : `<div class="nav-spacer"></div>`;

  return `<div class="page-nav">
    ${prevBtn}
    <button class="nav-btn nav-btn-home" onclick="showWelcome()">
      <span class="nav-home-icon">ğŸ“š</span>
      <span class="nav-home-label">ì „ì²´ ì±•í„°</span>
    </button>
    ${nextBtn}
  </div>`;
}

function showWelcome() {
  destroyCharts();
  document.querySelectorAll('.sub-item').forEach(el => el.classList.remove('active'));
  document.getElementById('breadcrumb').innerHTML = 'ì±•í„°ë¥¼ ì„ íƒí•´ í•™ìŠµì„ ì‹œì‘í•˜ì„¸ìš”';
  const area = document.getElementById('content-area');
  area.innerHTML = `
    <div class="welcome" id="welcome-screen">
      <h2>ğŸ“ í™•ì‚°ëª¨ë¸ í•™ìŠµ</h2>
      <p>ì™¼ìª½ ë©”ë‰´ì—ì„œ ì±•í„°ë¥¼ ì„ íƒí•˜ë©´ í•™ìŠµ ë‚´ìš©ì´ í‘œì‹œë©ë‹ˆë‹¤.<br>
         ìˆ˜ì‹, ì¸í„°ë ‰í‹°ë¸Œ ì‹œë®¬ë ˆì´ì…˜, ì½”ë“œ ì˜ˆì‹œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
      <div class="chapter-cards" id="chapter-cards-dyn"></div>
    </div>`;
  // rebuild chapter cards
  const cards2 = document.getElementById('chapter-cards-dyn');
  NAV.forEach(ch => {
    const hasContent = ch.subs.length > 0;
    const card = document.createElement('div');
    card.className = 'chapter-card';
    card.innerHTML = `<div class="num">Chapter ${ch.id}</div>
      <div class="title">${ch.title}</div>
      <div class="badge${hasContent ? '' : ' soon'}">${hasContent ? 'í•™ìŠµ ê°€ëŠ¥' : 'ì¤€ë¹„ì¤‘'}</div>`;
    if (hasContent) card.onclick = () => toggleChapter(ch.id, true);
    cards2.appendChild(card);
  });
  // close all sidebar chapters
  NAV.forEach(ch => toggleChapter(ch.id, false));
  area.scrollTop = 0;
}

/* ============================================================
   SECTION LOADER
   ============================================================ */
let activeChartInstances = {};

function destroyCharts() {
  Object.values(activeChartInstances).forEach(c => { try { c.destroy(); } catch(e){} });
  activeChartInstances = {};
}

function loadSection(id, ch, sub, sec) {
  // update nav state
  document.querySelectorAll('.sub-item').forEach(el => el.classList.remove('active'));
  const el = document.getElementById(`nav-${id}`);
  if (el) el.classList.add('active');
  toggleChapter(ch.id, true);

  // breadcrumb
  document.getElementById('breadcrumb').innerHTML =
    `Chapter ${ch.id} Â· ${ch.title} &nbsp;â€º&nbsp; <span>${sub.title}</span> â€º ${sec.title}`;

  // destroy old charts
  destroyCharts();

  // inject content + page navigation bar
  const area = document.getElementById('content-area');
  area.innerHTML = (CONTENT[id] || defaultContent(id, ch, sub, sec))() + buildPageNav(id);
  area.scrollTop = 0;

  // welcome screen hidden
  const ws = document.getElementById('welcome-screen');
  if (ws) ws.remove();

  // re-render MathJax then init charts
  if (window.MathJax) {
    MathJax.typesetPromise([area]).then(() => initChartsForPage(id));
  } else {
    initChartsForPage(id);
  }
}

function defaultContent(id, ch, sub, sec) {
  return () => `<div class="page-title">${sec.title}</div>
    <div class="page-subtitle">Chapter ${ch.id} Â· ${ch.title} > ${sub.title}</div>
    <div class="section">
      <div class="section-title"><span class="icon">ğŸš§</span> ì¤€ë¹„ì¤‘</div>
      <p>ì´ ì ˆì˜ ë‚´ìš©ì€ í˜„ì¬ ì¤€ë¹„ì¤‘ì…ë‹ˆë‹¤. ë‹¤ë¥¸ ì±•í„°ë¥¼ ë¨¼ì € í•™ìŠµí•´ ë³´ì„¸ìš”.</p>
      <a href="#" class="ch-link" onclick="toggleChapter(1,true);return false;">â† Chapter 1 ì •ê·œë¶„í¬ë¡œ ì´ë™</a>
    </div>`;
}

/* ============================================================
   CHART INIT DISPATCHER
   ============================================================ */
function initChartsForPage(id) {
  const inits = {
    '1.1.1': init_dice,
    '1.2.2': init_normal_basic,
    '1.2.3': init_param_explorer,
    '1.3.2': init_clt_sim,
    '1.4.2': init_sum_sim,
  };
  if (inits[id]) inits[id]();
}

/* ============================================================
   HELPER: normal PDF
   ============================================================ */
function normalPDF(x, mu, sigma) {
  return (1 / (Math.sqrt(2*Math.PI) * sigma)) *
         Math.exp(-Math.pow(x - mu, 2) / (2 * sigma * sigma));
}
function linspace(a, b, n) {
  const arr = [];
  const step = (b - a) / (n - 1);
  for (let i = 0; i < n; i++) arr.push(a + i * step);
  return arr;
}

/* ============================================================
   CONTENT DEFINITIONS
   ============================================================ */
const CONTENT = {};

/* ---------- 1.1.1 ---------- */
CONTENT['1.1.1'] = () => String.raw`
<div class="page-title">í™•ë¥  ë³€ìˆ˜ì™€ í™•ë¥  ë¶„í¬</div>
<div class="page-subtitle">1.1 í™•ë¥ ì˜ ê¸°ì´ˆ â€” ë¶ˆí™•ì‹¤ì„±ì„ ìˆ˜í•™ìœ¼ë¡œ ë‹¤ë£¨ëŠ” ë°©ë²•</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ²</span> ë¶ˆí™•ì‹¤ì„±ê³¼ í™•ë¥ </div>
  <p>í˜„ì‹¤ ì„¸ê³„ì—ëŠ” ì™„ë²½í•˜ê²Œ ì˜ˆì¸¡í•˜ê¸° ì–´ë ¤ìš´ ì¼ë“¤ì´ ë§ìŠµë‹ˆë‹¤. ì£¼ì‚¬ìœ„ë¥¼ ë˜ì¡Œì„ ë•Œ ì–´ë–¤ ëˆˆì´ ë‚˜ì˜¬ì§€, ë‚´ì¼ ê¸°ì˜¨ì´ ì •í™•íˆ ëª‡ ë„ì¼ì§€ â€” ì´ëŸ° <strong>ë¶ˆí™•ì‹¤ì„±(uncertainty)</strong>ì— ë§ì„œê¸° ìœ„í•´ í™•ë¥ ì„ í™œìš©í•©ë‹ˆë‹¤.</p>
  <p>ë¨¸ì‹ ëŸ¬ë‹ê³¼ ë”¥ëŸ¬ë‹ì—ì„œë„ ë°ì´í„°ë¥¼ ìƒì„±í•œ <em>í™•ë¥ ì  ê³¼ì •</em>ì„ ëª¨ë¸ë§í•˜ëŠ” ê²ƒì´ í•µì‹¬ì…ë‹ˆë‹¤. í™•ì‚°ëª¨ë¸ ì—­ì‹œ í™•ë¥  ë¶„í¬ë¥¼ í•™ìŠµí•˜ëŠ” ëª¨ë¸ì…ë‹ˆë‹¤.</p>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ“Š</span> í™•ë¥  ë³€ìˆ˜ (Random Variable)</div>
  <p><strong>í™•ë¥  ë³€ìˆ˜(random variable)</strong>ë€ ì–»ì„ ìˆ˜ ìˆëŠ” ê°’ì´ í™•ë¥ ì ìœ¼ë¡œ ê²°ì •ë˜ëŠ” ë³€ìˆ˜ì…ë‹ˆë‹¤. ë³´í†µ $x$ë¡œ í‘œê¸°í•©ë‹ˆë‹¤.</p>
  <div class="highlight-box">
    ì£¼ì‚¬ìœ„ì˜ ëˆˆì„ í™•ë¥  ë³€ìˆ˜ $x$ë¼ í•˜ë©´, ëˆˆ 3ì´ ë‚˜ì˜¬ í™•ë¥ ì„ $p(x=3)$ìœ¼ë¡œ í‘œê¸°í•©ë‹ˆë‹¤.
  </div>
  <p>í™•ë¥  ë³€ìˆ˜ê°€ ê°€ì§ˆ ìˆ˜ ìˆëŠ” ëª¨ë“  ê°’ì— ëŒ€í•´ ê·¸ í™•ë¥ ì„ ë‚˜ì—´í•œ ê²ƒì´ <strong>í™•ë¥  ë¶„í¬(probability distribution)</strong>ì…ë‹ˆë‹¤.</p>

  <h4 style="margin:16px 0 8px; color:#374151;">ì£¼ì‚¬ìœ„ì˜ í™•ë¥  ë¶„í¬ ì˜ˆì‹œ</h4>
  <table class="prob-table">
    <thead><tr><th>$x$ (ëˆˆ)</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th></tr></thead>
    <tbody><tr><td>$p(x)$</td><td>1/6</td><td>1/6</td><td>1/6</td><td>1/6</td><td>1/6</td><td>1/6</td></tr></tbody>
  </table>
  <p>ì´ì²˜ëŸ¼ ëª¨ë“  ë©´ì´ ë™ì¼í•œ í™•ë¥ ì„ ê°€ì§ˆ ë•Œ <strong>ê· ë“± ë¶„í¬(uniform distribution)</strong>ë¼ê³  í•©ë‹ˆë‹¤.</p>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ“</span> í™•ë¥  ë¶„í¬ì˜ ì¡°ê±´</div>
  <p>ì–´ë–¤ í•¨ìˆ˜ $p(x)$ê°€ í™•ë¥  ë¶„í¬ê°€ ë˜ë ¤ë©´ ë‘ ì¡°ê±´ì„ ë§Œì¡±í•´ì•¼ í•©ë‹ˆë‹¤:</p>
  <div class="math-block">
    $$0 \le p(x_k) \le 1 \quad (k = 1, 2, \ldots, N)$$
  </div>
  <div class="math-block">
    $$\sum_{k=1}^{N} p(x_k) = 1$$
  </div>
  <div class="highlight-box green">
    <strong>í•µì‹¬:</strong> ê° í™•ë¥ ì€ 0~1 ì‚¬ì´ì´ê³ , ëª¨ë“  í™•ë¥ ì˜ í•©ì€ ë°˜ë“œì‹œ 1ì´ì–´ì•¼ í•©ë‹ˆë‹¤.
  </div>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ®</span> ì£¼ì‚¬ìœ„ ì‹œë®¬ë ˆì´ì…˜</div>
  <p>ì£¼ì‚¬ìœ„ë¥¼ ì—¬ëŸ¬ ë²ˆ êµ´ë ¤ ê²½í—˜ì  í™•ë¥  ë¶„í¬ë¥¼ ê´€ì°°í•´ ë³´ì„¸ìš”. ì‹œí–‰ íšŸìˆ˜ê°€ ëŠ˜ì–´ë‚ ìˆ˜ë¡ ê· ë“± ë¶„í¬ì— ê°€ê¹Œì›Œì§€ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.</p>
  <div class="interactive-panel">
    <div class="panel-header">ğŸ² ì£¼ì‚¬ìœ„ ì‹œë®¬ë ˆì´í„°</div>
    <div class="panel-body" style="flex-direction:column;">
      <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;">
        <button class="btn btn-primary" onclick="rollDice(1)">1ë²ˆ êµ´ë¦¬ê¸°</button>
        <button class="btn btn-secondary" onclick="rollDice(10)">10ë²ˆ êµ´ë¦¬ê¸°</button>
        <button class="btn btn-secondary" onclick="rollDice(100)">100ë²ˆ êµ´ë¦¬ê¸°</button>
        <button class="btn btn-secondary" onclick="resetDice()">ì´ˆê¸°í™”</button>
        <span style="font-size:0.82rem;color:#64748b;margin-left:8px;">ì´ ì‹œí–‰: <strong id="dice-count">0</strong></span>
      </div>
      <div class="dice-grid" id="dice-display">
        <div class="die" id="die-face">?</div>
      </div>
      <canvas id="dice-chart" height="180"></canvas>
    </div>
  </div>
</div>
`;

/* ---------- 1.1.2 ---------- */
CONTENT['1.1.2'] = () => String.raw`
<div class="page-title">í™•ë¥  ë¶„í¬ì˜ ì¢…ë¥˜</div>
<div class="page-subtitle">1.1 í™•ë¥ ì˜ ê¸°ì´ˆ â€” ì´ì‚° vs ì—°ì†</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ”¢</span> ì´ì‚° vs ì—°ì† í™•ë¥  ë¶„í¬</div>
  <p>í™•ë¥  ë¶„í¬ëŠ” í™•ë¥  ë³€ìˆ˜ì˜ ì„±ì§ˆì— ë”°ë¼ ë‘ ê°€ì§€ë¡œ ë‚˜ë‰©ë‹ˆë‹¤.</p>
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin:16px 0;">
    <div class="highlight-box">
      <strong>ì´ì‚° í™•ë¥  ë¶„í¬</strong><br>
      í™•ë¥  ë³€ìˆ˜ê°€ 1, 2, 3ì²˜ëŸ¼ ë”± ë–¨ì–´ì§€ëŠ” ê°’ì„ ì·¨í•©ë‹ˆë‹¤.<br>
      ì˜ˆ: ì£¼ì‚¬ìœ„, ë™ì „ ë˜ì§€ê¸°
    </div>
    <div class="highlight-box purple">
      <strong>ì—°ì† í™•ë¥  ë¶„í¬</strong><br>
      í™•ë¥  ë³€ìˆ˜ê°€ ì—°ì†ì ì¸ ì‹¤ìˆ˜ê°’ì„ ì·¨í•©ë‹ˆë‹¤.<br>
      ì˜ˆ: í‚¤, ê¸°ì˜¨, ì¸¡ì • ì˜¤ì°¨
    </div>
  </div>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ“ˆ</span> í™•ë¥  ë°€ë„ í•¨ìˆ˜ (PDF)</div>
  <p>ì—°ì† í™•ë¥  ë³€ìˆ˜ì—ì„œ $p(x)$ëŠ” <strong>í™•ë¥  ë°€ë„(probability density)</strong>ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ì´ë•Œ "$x$ê°€ ì–´ë–¤ êµ¬ê°„ $[a, b]$ì— ìˆì„ í™•ë¥ "ì€ ê³¡ì„  ì•„ë˜ ë©´ì ìœ¼ë¡œ ê³„ì‚°ë©ë‹ˆë‹¤.</p>
  <div class="math-block">
    $$P(a \le x \le b) = \int_a^b p(x)\, dx$$
  </div>
  <p>ì—°ì† í™•ë¥  ë¶„í¬ë„ ì„±ë¦½ ì¡°ê±´ì´ ìˆìŠµë‹ˆë‹¤:</p>
  <div class="math-block">
    $$p(x) \ge 0, \qquad \int_{-\infty}^{\infty} p(x)\, dx = 1$$
  </div>
  <div class="highlight-box amber">
    <strong>ì£¼ì˜:</strong> ì—°ì† í™•ë¥  ë³€ìˆ˜ì—ì„œ $p(x)$ëŠ” í™•ë¥ ì´ ì•„ë‹Œ <em>ë°€ë„</em>ì…ë‹ˆë‹¤. $p(x) > 1$ì´ ë  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤! í™•ë¥ ì€ í•­ìƒ ì ë¶„ìœ¼ë¡œ êµ¬í•©ë‹ˆë‹¤.
  </div>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ”—</span> ì•ìœ¼ë¡œ ë°°ìš¸ ë¶„í¬ë“¤</div>
  <ul class="content-list">
    <li><a class="ch-link" href="#" onclick="loadSection('1.2.1',NAV[0],NAV[0].subs[1],NAV[0].subs[1].sections[0]);return false;">ğŸ“ ì •ê·œ ë¶„í¬ (Chapter 1.2)</a> â€” ê°€ì¥ ì¤‘ìš”í•œ ì—°ì† í™•ë¥  ë¶„í¬</li>
    <li><a class="ch-link" href="#" onclick="alert('Chapter 2ì—ì„œ í•™ìŠµí•©ë‹ˆë‹¤.')">ğŸ“ ìµœëŒ€ ê°€ëŠ¥ë„ ì¶”ì • (Chapter 2)</a> â€” ë¶„í¬ì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ë°ì´í„°ë¡œ ì¶”ì •</li>
    <li><a class="ch-link" href="#" onclick="alert('Chapter 3ì—ì„œ í•™ìŠµí•©ë‹ˆë‹¤.')">ğŸ“ ë‹¤ë³€ëŸ‰ ì •ê·œ ë¶„í¬ (Chapter 3)</a> â€” ê³ ì°¨ì› ë°ì´í„°ë¡œ í™•ì¥</li>
    <li><a class="ch-link" href="#" onclick="alert('Chapter 4ì—ì„œ í•™ìŠµí•©ë‹ˆë‹¤.')">ğŸ“ ê°€ìš°ìŠ¤ í˜¼í•© ëª¨ë¸ (Chapter 4)</a> â€” ì—¬ëŸ¬ ì •ê·œ ë¶„í¬ì˜ í˜¼í•©</li>
  </ul>
</div>
`;

/* ---------- 1.1.3 ---------- */
CONTENT['1.1.3'] = () => String.raw`
<div class="page-title">ê¸°ëŒ€ê°’ê³¼ ë¶„ì‚°</div>
<div class="page-subtitle">1.1 í™•ë¥ ì˜ ê¸°ì´ˆ â€” ë¶„í¬ì˜ íŠ¹ì„±ì„ ìš”ì•½í•˜ëŠ” ë‘ ìˆ˜ì¹˜</div>

<div class="section">
  <div class="section-title"><span class="icon">âš–ï¸</span> ê¸°ëŒ€ê°’ (Expected Value)</div>
  <p><strong>ê¸°ëŒ€ê°’(expected value)</strong> $\mathbb{E}[x]$ì€ í•œ ë²ˆì˜ ê´€ì¸¡ìœ¼ë¡œ ì–»ì„ ìˆ˜ ìˆëŠ” ê°’ì˜ í‰ê· ì…ë‹ˆë‹¤. ë¬´í•œíˆ ë§ì´ ê´€ì¸¡í–ˆì„ ë•Œì˜ í‰ê· ê°’ì´ë¼ê³  ì§ê´€ì ìœ¼ë¡œ ì´í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
  <div class="math-block">
    $$\mathbb{E}[x] = \sum_{k=1}^{N} x_k\, p(x_k) \quad \text{(ì´ì‚°)}$$
    $$\mathbb{E}[x] = \int_{-\infty}^{\infty} x\, p(x)\, dx \quad \text{(ì—°ì†)}$$
  </div>
  <div class="highlight-box">
    ì£¼ì‚¬ìœ„ì˜ ê¸°ëŒ€ê°’: $\mu = 1 \cdot \tfrac{1}{6} + 2 \cdot \tfrac{1}{6} + \cdots + 6 \cdot \tfrac{1}{6} = 3.5$
  </div>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ“</span> ë¶„ì‚° (Variance)</div>
  <p><strong>ë¶„ì‚°(variance)</strong> $\text{Var}[x]$ì€ ê°’ì´ ê¸°ëŒ€ê°’ ì£¼ìœ„ì—ì„œ ì–¼ë§ˆë‚˜ í¼ì ¸ ìˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ë¶„ì‚°ì˜ ì œê³±ê·¼ì´ <strong>í‘œì¤€í¸ì°¨</strong> $\sigma$ì…ë‹ˆë‹¤.</p>
  <div class="math-block">
    $$\text{Var}[x] = \mathbb{E}[(x - \mu)^2] = \mathbb{E}[x^2] - \mu^2$$
  </div>
  <div class="math-block">
    $$\text{Var}[x] = \sum_{k=1}^{N} (x_k - \mu)^2\, p(x_k) \quad \text{(ì´ì‚°)}$$
  </div>
  <p>ì£¼ì‚¬ìœ„ì˜ ë¶„ì‚°:</p>
  <div class="math-block">
    $$\sigma^2 = \sum_{k=1}^{6}(k - 3.5)^2 \cdot \tfrac{1}{6} = \tfrac{35}{12} \approx 2.917$$
  </div>
  <div class="highlight-box green">
    ë¶„ì‚°ì´ <strong>í¬ë©´</strong> ë°ì´í„°ê°€ ë„“ê²Œ í¼ì ¸ ìˆê³ , <strong>ì‘ìœ¼ë©´</strong> ê¸°ëŒ€ê°’ ì£¼ìœ„ì— ëª°ë ¤ ìˆìŠµë‹ˆë‹¤. ì´ê²ƒì´ ì •ê·œ ë¶„í¬ì˜ $\sigma$(í‘œì¤€í¸ì°¨)ê°€ ë‚˜íƒ€ë‚´ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.
    <br><a class="ch-link" href="#" onclick="loadSection('1.2.3',NAV[0],NAV[0].subs[1],NAV[0].subs[1].sections[2]);return false;">â†’ 1.2.3 ë§¤ê°œë³€ìˆ˜ì˜ ì—­í• ì—ì„œ ì§ì ‘ í™•ì¸</a>
  </div>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ“Š</span> ê¸°ëŒ€ê°’ì˜ ì„ í˜•ì„±</div>
  <p>ê¸°ëŒ€ê°’ì€ ë‹¤ìŒì˜ í¸ë¦¬í•œ ì„±ì§ˆì„ ê°€ì§‘ë‹ˆë‹¤ (ì´í›„ ì±•í„°ì—ì„œ ìì£¼ ì‚¬ìš©ë©ë‹ˆë‹¤):</p>
  <div class="math-block">
    $$\mathbb{E}[ax + b] = a\mathbb{E}[x] + b$$
    $$\mathbb{E}[x + y] = \mathbb{E}[x] + \mathbb{E}[y]$$
  </div>
  <div class="highlight-box amber">
    <strong>ë…ë¦½ ë³€ìˆ˜ì˜ ë¶„ì‚°:</strong> $x$, $y$ê°€ ë…ë¦½ì´ë©´ $\text{Var}[x + y] = \text{Var}[x] + \text{Var}[y]$. ì´ ì„±ì§ˆì´ <a class="ch-link" href="#" onclick="loadSection('1.3.1',NAV[0],NAV[0].subs[2],NAV[0].subs[2].sections[0]);return false;">ì¤‘ì‹¬ ê·¹í•œ ì •ë¦¬</a>ì˜ í•µì‹¬ì…ë‹ˆë‹¤.
  </div>
</div>
`;

/* ---------- 1.2.1 ---------- */
CONTENT['1.2.1'] = () => String.raw`
<div class="page-title">ì •ê·œ ë¶„í¬ì˜ í™•ë¥  ë°€ë„ í•¨ìˆ˜</div>
<div class="page-subtitle">1.2 ì •ê·œ ë¶„í¬ â€” ìì—°ê³„ì—ì„œ ê°€ì¥ ìì£¼ ë“±ì¥í•˜ëŠ” ë¶„í¬</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ””</span> ì •ê·œ ë¶„í¬ (Gaussian Distribution)</div>
  <p>ì •ê·œ ë¶„í¬ëŠ” <strong>í‰ê·  $\mu$</strong>ì™€ <strong>í‘œì¤€í¸ì°¨ $\sigma$</strong> ë‘ ë§¤ê°œë³€ìˆ˜ë§Œìœ¼ë¡œ ê²°ì •ë˜ëŠ” ì—°ì† í™•ë¥  ë¶„í¬ì…ë‹ˆë‹¤. ì¢… ëª¨ì–‘(bell curve)ì˜ ëŒ€ì¹­ ë¶„í¬ì…ë‹ˆë‹¤.</p>
  <div class="math-block">
    $$\mathcal{N}(x;\,\mu,\,\sigma) = \frac{1}{\sqrt{2\pi}\,\sigma} \exp\!\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)$$
    <div class="formula-label">ì •ê·œ ë¶„í¬ì˜ í™•ë¥  ë°€ë„ í•¨ìˆ˜ (PDF)</div>
  </div>
  <div class="highlight-box">
    <strong>í‘œê¸°ë²•:</strong> "$x$ê°€ í‰ê·  $\mu$, í‘œì¤€í¸ì°¨ $\sigma$ì¸ ì •ê·œ ë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤"ë¥¼ $x \sim \mathcal{N}(\mu, \sigma^2)$ ë˜ëŠ” $x \sim \mathcal{N}(\mu, \sigma)$ë¡œ ì”ë‹ˆë‹¤.
  </div>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ”</span> ìˆ˜ì‹ ë¶„í•´í•˜ê¸°</div>
  <ul class="content-list">
    <li><strong>$\frac{1}{\sqrt{2\pi}\,\sigma}$</strong> â€” ì •ê·œí™” ìƒìˆ˜. ì „ì²´ ë©´ì ì´ 1ì´ ë˜ë„ë¡ ì¡°ì •í•©ë‹ˆë‹¤.</li>
    <li><strong>$\exp\!\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)$</strong> â€” ê°€ìš°ìŠ¤ í•¨ìˆ˜. $x=\mu$ì—ì„œ ìµœëŒ“ê°’ 1, $x$ê°€ $\mu$ì—ì„œ ë©€ì–´ì§ˆìˆ˜ë¡ 0ì— ê°€ê¹Œì›Œì§‘ë‹ˆë‹¤.</li>
    <li><strong>$(x - \mu)^2$</strong> â€” $\mu$ë¡œë¶€í„°ì˜ ê±°ë¦¬ ì œê³±. ëŒ€ì¹­ì„±ì„ ë§Œë“¤ì–´ëƒ…ë‹ˆë‹¤.</li>
    <li><strong>$2\sigma^2$</strong> â€” ë¶„ëª¨. $\sigma$ê°€ í´ìˆ˜ë¡ ë¶„í¬ê°€ ì™„ë§Œ(ë„“ê²Œ)í•´ì§‘ë‹ˆë‹¤.</li>
  </ul>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ“</span> í‘œì¤€ ì •ê·œ ë¶„í¬</div>
  <p>$\mu = 0$, $\sigma = 1$ì¸ íŠ¹ë³„í•œ ê²½ìš°ë¥¼ <strong>í‘œì¤€ ì •ê·œ ë¶„í¬</strong>ë¼ í•©ë‹ˆë‹¤.</p>
  <div class="math-block">
    $$\mathcal{N}(x;\,0,\,1) = \frac{1}{\sqrt{2\pi}} \exp\!\left(-\frac{x^2}{2}\right)$$
  </div>

  <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:16px;">
    <div class="stat-card">
      <div class="label">í‰ê·  $\mu$ë¡œë¶€í„° $\pm\sigma$ ì´ë‚´</div>
      <div class="value" style="font-size:1.1rem;">68.3%</div>
    </div>
    <div class="stat-card">
      <div class="label">$\pm 2\sigma$ ì´ë‚´</div>
      <div class="value" style="font-size:1.1rem;">95.4%</div>
    </div>
    <div class="stat-card">
      <div class="label">$\pm 3\sigma$ ì´ë‚´</div>
      <div class="value" style="font-size:1.1rem;">99.7%</div>
    </div>
  </div>
  <p style="margin-top:12px;">ì´ê²ƒì„ <strong>68-95-99.7 ë²•ì¹™</strong> (ë˜ëŠ” ê²½í—˜ ë²•ì¹™)ì´ë¼ í•©ë‹ˆë‹¤.</p>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ”—</span> ì •ê·œ ë¶„í¬ì˜ ê¸°ëŒ€ê°’ê³¼ ë¶„ì‚°</div>
  <p>ì •ê·œ ë¶„í¬ì˜ ê¸°ëŒ€ê°’ê³¼ ë¶„ì‚°ì€ ë§¤ê°œë³€ìˆ˜ì™€ ì§ì ‘ ì—°ê²°ë©ë‹ˆë‹¤:</p>
  <div class="math-block">
    $$\mathbb{E}[x] = \mu, \qquad \text{Var}[x] = \sigma^2$$
  </div>
  <div class="highlight-box green">
    ì¦‰, ë§¤ê°œë³€ìˆ˜ $\mu$ê°€ ë°”ë¡œ í‰ê· ì´ê³ , $\sigma$ê°€ í‘œì¤€í¸ì°¨ì…ë‹ˆë‹¤. ì§ì ‘ í™•ì¸í•˜ë ¤ë©´ <a class="ch-link" href="#" onclick="loadSection('1.2.3',NAV[0],NAV[0].subs[1],NAV[0].subs[1].sections[2]);return false;">â†’ 1.2.3 ë§¤ê°œë³€ìˆ˜ì˜ ì—­í• </a>ì„ ì°¸ê³ í•˜ì„¸ìš”.
  </div>
  <p>ì •ê·œ ë¶„í¬ì˜ ê¸°ëŒ€ê°’ê³¼ ë¶„ì‚° ë„ì¶œì€ <a class="ch-link" href="#" onclick="alert('ë¶€ë¡ Aì—ì„œ ë‹¤ë³€ëŸ‰ ì •ê·œ ë¶„í¬ì˜ MLEì™€ í•¨ê»˜ ë‹¤ë£¹ë‹ˆë‹¤.')">ë¶€ë¡ A</a>ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.</p>
</div>
`;

/* ---------- 1.2.2 ---------- */
CONTENT['1.2.2'] = () => String.raw`
<div class="page-title">ì •ê·œ ë¶„í¬ ì‹œê°í™”</div>
<div class="page-subtitle">1.2 ì •ê·œ ë¶„í¬ â€” í‘œì¤€ ì •ê·œ ë¶„í¬ë¥¼ ì½”ë“œë¡œ ê·¸ë ¤ë³´ê¸°</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ’»</span> Python ì½”ë“œ</div>
  <p>ë‹¤ìŒì€ í‘œì¤€ ì •ê·œ ë¶„í¬ë¥¼ NumPyì™€ Matplotlibìœ¼ë¡œ ê·¸ë¦¬ëŠ” ì½”ë“œì…ë‹ˆë‹¤:</p>
  <pre style="background:#1e293b;color:#e2e8f0;padding:16px;border-radius:8px;font-size:0.82rem;line-height:1.7;overflow-x:auto;"><code>import numpy as np
import matplotlib.pyplot as plt

def normal(x, mu=0, sigma=1):
    y = 1 / (np.sqrt(2 * np.pi) * sigma) * \
        np.exp(-(x - mu)**2 / (2 * sigma**2))
    return y

x = np.linspace(-5, 5, 100)
y = normal(x)          # mu=0, sigma=1

plt.plot(x, y)
plt.xlabel('x')
plt.ylabel('p(x)')
plt.show()</code></pre>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ“Š</span> ì¸í„°ë ‰í‹°ë¸Œ ì‹œê°í™”</div>
  <p>í‘œì¤€ ì •ê·œ ë¶„í¬ $\mathcal{N}(x; 0, 1)$ì™€ íŠ¹ì • êµ¬ê°„ì˜ í™•ë¥ (ë©´ì )ì„ í™•ì¸í•´ ë³´ì„¸ìš”.</p>
  <div class="interactive-panel">
    <div class="panel-header">ğŸ“ˆ í‘œì¤€ ì •ê·œ ë¶„í¬ Â· êµ¬ê°„ í™•ë¥  ê³„ì‚°</div>
    <div class="panel-body">
      <div class="chart-wrap"><canvas id="normal-basic-chart" height="220"></canvas></div>
      <div class="controls-wrap">
        <div class="ctrl-group">
          <div class="ctrl-label">êµ¬ê°„ ì™¼ìª½: a = <span id="a-val">-1.00</span></div>
          <input type="range" id="a-slider" min="-4" max="4" step="0.1" value="-1"
            oninput="document.getElementById('a-val').textContent=parseFloat(this.value).toFixed(2); updateNormalBasic();">
        </div>
        <div class="ctrl-group">
          <div class="ctrl-label">êµ¬ê°„ ì˜¤ë¥¸ìª½: b = <span id="b-val">1.00</span></div>
          <input type="range" id="b-slider" min="-4" max="4" step="0.1" value="1"
            oninput="document.getElementById('b-val').textContent=parseFloat(this.value).toFixed(2); updateNormalBasic();">
        </div>
        <div class="stat-grid" style="grid-template-columns:1fr;">
          <div class="stat-card">
            <div class="label">P(a â‰¤ x â‰¤ b)</div>
            <div class="value" id="prob-value">68.3%</div>
          </div>
          <div class="stat-card">
            <div class="label">ìµœëŒ“ê°’ p(0)</div>
            <div class="value">0.399</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
`;

/* ---------- 1.2.3 ---------- */
CONTENT['1.2.3'] = () => String.raw`
<div class="page-title">ë§¤ê°œë³€ìˆ˜ì˜ ì—­í• </div>
<div class="page-subtitle">1.2 ì •ê·œ ë¶„í¬ â€” Î¼ì™€ Ïƒê°€ ë¶„í¬ ëª¨ì–‘ì— ì–´ë–¤ ì˜í–¥ì„ ì£¼ëŠ”ê°€?</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ›ï¸</span> Î¼: ìœ„ì¹˜ ë§¤ê°œë³€ìˆ˜</div>
  <p>$\mu$ëŠ” ë¶„í¬ì˜ <strong>ì¤‘ì‹¬ ìœ„ì¹˜</strong>ë¥¼ ê²°ì •í•©ë‹ˆë‹¤. $\mu$ê°€ ë°”ë€Œë©´ ë¶„í¬ ì „ì²´ê°€ ì¢Œìš°ë¡œ ì´ë™í•˜ì§€ë§Œ <em>ëª¨ì–‘ì€ ë³€í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤</em>.</p>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ›ï¸</span> Ïƒ: ì²™ë„ ë§¤ê°œë³€ìˆ˜</div>
  <p>$\sigma$ëŠ” ë¶„í¬ì˜ <strong>í¼ì§(ë„ˆë¹„)</strong>ì„ ê²°ì •í•©ë‹ˆë‹¤. $\sigma$ê°€ í´ìˆ˜ë¡ ë¶„í¬ê°€ ë„“ê³  ë‚©ì‘í•´ì§€ë©°, ì‘ì„ìˆ˜ë¡ ì¢ê³  ë¾°ì¡±í•´ì§‘ë‹ˆë‹¤.</p>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ“Š</span> ì¸í„°ë ‰í‹°ë¸Œ íƒìƒ‰ê¸°</div>
  <p>ìŠ¬ë¼ì´ë”ë¥¼ ì›€ì§ì—¬ $\mu$ì™€ $\sigma$ê°€ ë¶„í¬ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ì§ì ‘ í™•ì¸í•˜ì„¸ìš”.</p>
  <div class="interactive-panel">
    <div class="panel-header">ğŸ›ï¸ ë§¤ê°œë³€ìˆ˜ íƒìƒ‰ê¸° (ìŠ¬ë¼ì´ë”)</div>
    <div class="panel-body">
      <div class="chart-wrap"><canvas id="param-chart" height="250"></canvas></div>
      <div class="controls-wrap">
        <div class="ctrl-group">
          <div class="ctrl-label">Î¼ (í‰ê· ): <span id="mu-val">0.0</span></div>
          <div class="ctrl-row">
            <input type="range" id="mu-slider" min="-4" max="4" step="0.1" value="0"
              oninput="document.getElementById('mu-val').textContent=parseFloat(this.value).toFixed(1); updateParamChart();">
            <span class="val-badge" id="mu-badge">0.0</span>
          </div>
        </div>
        <div class="ctrl-group">
          <div class="ctrl-label">Ïƒ (í‘œì¤€í¸ì°¨): <span id="sigma-val">1.0</span></div>
          <div class="ctrl-row">
            <input type="range" id="sigma-slider" min="0.2" max="3" step="0.1" value="1"
              oninput="document.getElementById('sigma-val').textContent=parseFloat(this.value).toFixed(1); updateParamChart();">
            <span class="val-badge" id="sigma-badge">1.0</span>
          </div>
        </div>
        <div class="ctrl-group" style="margin-top:8px;">
          <div class="ctrl-label">ë¹„êµìš© ë¶„í¬ í‘œì‹œ</div>
          <label style="font-size:0.8rem;color:#374151;cursor:pointer;">
            <input type="checkbox" id="show-ref" checked onchange="updateParamChart()"> ê¸°ì¤€ ë¶„í¬ (Î¼=0, Ïƒ=1)
          </label>
        </div>
        <div class="stat-grid" style="grid-template-columns:1fr;margin-top:12px;">
          <div class="stat-card">
            <div class="label">p(Î¼) ìµœëŒ“ê°’</div>
            <div class="value" id="peak-val">0.399</div>
          </div>
          <div class="stat-card">
            <div class="label">ë¶„ì‚° ÏƒÂ²</div>
            <div class="value" id="var-val">1.00</div>
          </div>
        </div>
        <div class="highlight-box" style="margin-top:12px;font-size:0.8rem;">
          <strong>ê´€ì°°:</strong> Ïƒê°€ 2ë°° â†’ ìµœëŒ“ê°’ì€ ì ˆë°˜, ë„ˆë¹„ëŠ” 2ë°°
        </div>
      </div>
    </div>
  </div>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ“</span> ìˆ˜ì‹ ìš”ì•½</div>
  <div class="math-block">
    $$\mathcal{N}(x;\,\mu,\,\sigma) = \frac{1}{\sqrt{2\pi}\,\sigma} \exp\!\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)$$
  </div>
  <ul class="content-list">
    <li>$\mu$ ë³€í™” â†’ ë¶„í¬ê°€ ìˆ˜í‰ ì´ë™ (ëª¨ì–‘ ë¶ˆë³€)</li>
    <li>$\sigma$ ë³€í™” â†’ ë¶„í¬ì˜ í­ê³¼ ë†’ì´ ë³€í™” (ì •ê·œí™” ìƒìˆ˜ ë•Œë¬¸)</li>
    <li>$\sigma \to 0$ â†’ ë””ë™ ë¸íƒ€ í•¨ìˆ˜ $\delta(x-\mu)$ì— ìˆ˜ë ´</li>
  </ul>
  <div class="highlight-box purple">
    ì´ ë‘ ë§¤ê°œë³€ìˆ˜ê°€ ë°”ë¡œ <a class="ch-link" href="#" onclick="alert('Chapter 2ì—ì„œ í•™ìŠµí•©ë‹ˆë‹¤.')">ìµœëŒ€ ê°€ëŠ¥ë„ ì¶”ì •(MLE, Chapter 2)</a>ì„ í†µí•´ ë°ì´í„°ë¡œë¶€í„° í•™ìŠµí•˜ëŠ” ëŒ€ìƒì…ë‹ˆë‹¤.
  </div>
</div>
`;

/* ---------- 1.3.1 ---------- */
CONTENT['1.3.1'] = () => String.raw`
<div class="page-title">ì¤‘ì‹¬ ê·¹í•œ ì •ë¦¬ë€?</div>
<div class="page-subtitle">1.3 ì¤‘ì‹¬ ê·¹í•œ ì •ë¦¬ â€” ì •ê·œ ë¶„í¬ê°€ ì–´ë””ì„œë‚˜ ë‚˜íƒ€ë‚˜ëŠ” ì´ìœ </div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸŒŸ</span> í†µê³„í•™ì—ì„œ ê°€ì¥ ì•„ë¦„ë‹¤ìš´ ì •ë¦¬</div>
  <p><strong>ì¤‘ì‹¬ ê·¹í•œ ì •ë¦¬(Central Limit Theorem, CLT)</strong>ëŠ” ì •ê·œ ë¶„í¬ê°€ ê°€ì¥ ì¤‘ìš”í•œ í™•ë¥  ë¶„í¬ì¸ ì´ìœ ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤. ì§ê´€ì ìœ¼ë¡œ ë§í•˜ë©´:</p>
  <div class="highlight-box" style="font-size:1rem;text-align:center;">
    <strong>ì–´ë–¤ ë¶„í¬ë¥¼ ë”°ë¥´ëŠ” í™•ë¥  ë³€ìˆ˜ë“ ,<br>
    í‘œë³¸ í‰ê· ì€ í‘œë³¸ í¬ê¸°ê°€ ì»¤ì§ˆìˆ˜ë¡ ì •ê·œ ë¶„í¬ì— ê°€ê¹Œì›Œì§„ë‹¤.</strong>
  </div>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ“</span> ìˆ˜ì‹ìœ¼ë¡œ ë³´ëŠ” CLT</div>
  <p>ê°™ì€ ë¶„í¬ì—ì„œ ë…ë¦½ì ìœ¼ë¡œ ì¶”ì¶œí•œ $N$ê°œì˜ í‘œë³¸ì„ $x^{(1)}, x^{(2)}, \ldots, x^{(N)}$ì´ë¼ í•  ë•Œ, <strong>í‘œë³¸ í‰ê· </strong>ì€:</p>
  <div class="math-block">
    $$\bar{x} = \frac{x^{(1)} + x^{(2)} + \cdots + x^{(N)}}{N}$$
  </div>
  <p>ì›ë˜ ë¶„í¬ì˜ í‰ê· ì´ $\mu$, ë¶„ì‚°ì´ $\sigma^2$ì´ë©´:</p>
  <div class="math-block">
    $$\mathbb{E}[\bar{x}] = \mu, \qquad \text{Var}[\bar{x}] = \frac{\sigma^2}{N}$$
  </div>
  <p>ê·¸ë¦¬ê³  $N \to \infty$ì´ë©´:</p>
  <div class="math-block">
    $$\bar{x} \xrightarrow{d} \mathcal{N}\!\left(\mu,\, \frac{\sigma}{\sqrt{N}}\right)$$
  </div>
  <div class="highlight-box green">
    <strong>í•µì‹¬:</strong> ì›ë˜ ë¶„í¬ê°€ ë¬´ì—‡ì´ë“  ìƒê´€ì—†ì´, $N$ì´ ì»¤ì§€ë©´ í‘œë³¸ í‰ê· ì€ ì •ê·œ ë¶„í¬ë¡œ ìˆ˜ë ´í•©ë‹ˆë‹¤.
  </div>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ”¬</span> CLTê°€ ì¤‘ìš”í•œ ì´ìœ </div>
  <div class="steps">
    <div class="step active"><div class="step-num">1</div>ì–´ë–¤ ë¶„í¬ì—ì„œë“  í‘œë³¸ ì¶”ì¶œ</div>
    <div class="step active"><div class="step-num">2</div>Nê°œì”© ë¬¶ì–´ í‰ê·  ê³„ì‚°</div>
    <div class="step active"><div class="step-num">3</div>Nì´ í¬ë©´ ì •ê·œ ë¶„í¬!</div>
    <div class="step active"><div class="step-num">4</div>í†µê³„ ì¶”ë¡  ê°€ëŠ¥</div>
  </div>
  <ul class="content-list">
    <li>í˜„ì‹¤ì˜ ë§ì€ í˜„ìƒì´ ì •ê·œ ë¶„í¬ë¥¼ ë”°ë¥´ëŠ” ì´ìœ ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤ (<a class="ch-link" href="#" onclick="loadSection('1.5.1',NAV[0],NAV[0].subs[4],NAV[0].subs[4].sections[0]);return false;">â†’ 1.5 ìš°ë¦¬ ì£¼ë³€ì˜ ì •ê·œ ë¶„í¬</a>)</li>
    <li>í†µê³„ ê²€ì •ê³¼ ì‹ ë¢°êµ¬ê°„ì˜ ì´ë¡ ì  ê·¼ê±°ì…ë‹ˆë‹¤</li>
    <li>í‘œë³¸ í¬ê¸°ê°€ í´ìˆ˜ë¡ ì¶”ì •ì´ ì •í™•í•´ì§€ëŠ” ì´ìœ ì…ë‹ˆë‹¤</li>
  </ul>
  <div class="highlight-box purple">
    ì§ì ‘ ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ í™•ì¸í•´ ë³´ì„¸ìš”! â†’ <a class="ch-link" href="#" onclick="loadSection('1.3.2',NAV[0],NAV[0].subs[2],NAV[0].subs[2].sections[1]);return false;">1.3.2 CLT ì‹œë®¬ë ˆì´ì…˜</a>
  </div>
</div>
`;

/* ---------- 1.3.2 ---------- */
CONTENT['1.3.2'] = () => String.raw`
<div class="page-title">CLT ì‹œë®¬ë ˆì´ì…˜</div>
<div class="page-subtitle">1.3 ì¤‘ì‹¬ ê·¹í•œ ì •ë¦¬ â€” ê· ë“± ë¶„í¬ì˜ í‘œë³¸ í‰ê· ì´ ì •ê·œ ë¶„í¬ë¡œ ìˆ˜ë ´í•˜ëŠ” ê³¼ì •</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ§ª</span> ì‹¤í—˜ ì„¤ê³„</div>
  <p>ê· ë“± ë¶„í¬ $\text{Uniform}(0, 1)$ì—ì„œ $N$ê°œë¥¼ í‘œë³¸ ì¶”ì¶œí•˜ì—¬ í‰ê· ì„ êµ¬í•˜ëŠ” ì‹¤í—˜ì„ 10,000ë²ˆ ë°˜ë³µí•©ë‹ˆë‹¤.</p>
  <ul class="content-list">
    <li>$N = 1$: ê· ë“± ë¶„í¬ ê·¸ ìì²´ (ì§ì‚¬ê°í˜•)</li>
    <li>$N = 2$: ì‚¼ê°í˜• ë¶„í¬</li>
    <li>$N \ge 4$: ì •ê·œ ë¶„í¬ì™€ ë¹„ìŠ·í•´ì§‘ë‹ˆë‹¤</li>
    <li>$N = 30$: ì¼ë°˜ì ìœ¼ë¡œ ì¶©ë¶„íˆ ì •ê·œ ë¶„í¬ì— ê°€ê¹ë‹¤ê³  ë´…ë‹ˆë‹¤</li>
  </ul>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ®</span> ì¸í„°ë ‰í‹°ë¸Œ ì‹œë®¬ë ˆì´ì…˜</div>
  <div class="interactive-panel">
    <div class="panel-header">ğŸ”¬ ì¤‘ì‹¬ ê·¹í•œ ì •ë¦¬ ì‹¤í—˜ (ê· ë“± ë¶„í¬)</div>
    <div class="panel-body">
      <div class="chart-wrap"><canvas id="clt-chart" height="260"></canvas></div>
      <div class="controls-wrap">
        <div class="ctrl-group">
          <div class="ctrl-label">í‘œë³¸ í¬ê¸° N = <span id="clt-n-val">4</span></div>
          <input type="range" id="clt-n-slider" min="1" max="50" step="1" value="4"
            oninput="document.getElementById('clt-n-val').textContent=this.value;">
        </div>
        <div class="ctrl-group">
          <div class="ctrl-label">ì‹¤í—˜ íšŸìˆ˜</div>
          <select id="clt-trials" style="width:100%;padding:6px;border:1px solid #e2e8f0;border-radius:6px;font-size:0.83rem;">
            <option value="1000">1,000ë²ˆ</option>
            <option value="5000" selected>5,000ë²ˆ</option>
            <option value="10000">10,000ë²ˆ</option>
          </select>
        </div>
        <button class="btn btn-primary" style="width:100%;margin-bottom:10px;" onclick="runCLT()">â–¶ ì‹œë®¬ë ˆì´ì…˜ ì‹¤í–‰</button>
        <div class="stat-grid" style="grid-template-columns:1fr 1fr;">
          <div class="stat-card">
            <div class="label">ì´ë¡  í‰ê· </div>
            <div class="value" id="clt-theory-mu">0.50</div>
          </div>
          <div class="stat-card">
            <div class="label">ì‹¤í—˜ í‰ê· </div>
            <div class="value" id="clt-emp-mu">â€”</div>
          </div>
          <div class="stat-card">
            <div class="label">ì´ë¡  Ïƒ</div>
            <div class="value" id="clt-theory-sigma">0.289</div>
          </div>
          <div class="stat-card">
            <div class="label">ì‹¤í—˜ Ïƒ</div>
            <div class="value" id="clt-emp-sigma">â€”</div>
          </div>
        </div>
        <div class="highlight-box" style="margin-top:10px;font-size:0.78rem;">
          ì´ë¡ ê°’: ê· ë“± ë¶„í¬ì˜ $\mu=0.5$, $\sigma=1/\sqrt{12N}$
        </div>
      </div>
    </div>
  </div>
</div>
`;

/* ---------- 1.4.1 ---------- */
CONTENT['1.4.1'] = () => String.raw`
<div class="page-title">í‘œë³¸ í•©ì˜ ê¸°ëŒ€ê°’ê³¼ ë¶„ì‚°</div>
<div class="page-subtitle">1.4 í‘œë³¸ í•©ì˜ í™•ë¥  ë¶„í¬</div>

<div class="section">
  <div class="section-title"><span class="icon">â•</span> í‘œë³¸ í•© ì •ì˜</div>
  <p>í‘œë³¸ í‰ê·  ëŒ€ì‹  <strong>í‘œë³¸ í•©(sample sum)</strong>ì„ ìƒê°í•´ë´…ë‹ˆë‹¤:</p>
  <div class="math-block">
    $$s = x^{(1)} + x^{(2)} + \cdots + x^{(N)} = N\bar{x}$$
  </div>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ“</span> í‘œë³¸ í•©ì˜ ê¸°ëŒ€ê°’</div>
  <div class="math-block">
    $$\mathbb{E}[s] = \mathbb{E}[N\bar{x}] = N\,\mathbb{E}[\bar{x}] = N\mu$$
  </div>
  <p>ë„ì¶œ ê³¼ì •:</p>
  <div class="math-block">
    $$\mathbb{E}[N\bar{x}] = \int N\bar{x}\, p(\bar{x})\, d\bar{x} = N\int \bar{x}\, p(\bar{x})\, d\bar{x} = N\mathbb{E}[\bar{x}] = N\mu$$
  </div>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ“</span> í‘œë³¸ í•©ì˜ ë¶„ì‚°</div>
  <div class="math-block">
    $$\text{Var}[s] = \text{Var}[N\bar{x}] = N^2\,\text{Var}[\bar{x}] = N^2 \cdot \frac{\sigma^2}{N} = N\sigma^2$$
  </div>
  <p>ë”°ë¼ì„œ í‘œë³¸ í•©ì˜ í‘œì¤€í¸ì°¨ëŠ” $\sqrt{N}\,\sigma$ ì…ë‹ˆë‹¤. ë°˜ë©´ í‘œë³¸ í‰ê· ì˜ í‘œì¤€í¸ì°¨ëŠ” $\sigma/\sqrt{N}$ì´ì—ˆìŠµë‹ˆë‹¤.</p>
  <div class="highlight-box amber">
    <strong>ë¹„êµ:</strong><br>
    í‘œë³¸ í‰ê· ì˜ ë¶„ì‚°: $\sigma^2/N$ â†’ $N$ì´ ì¦ê°€í•˜ë©´ <em>ê°ì†Œ</em><br>
    í‘œë³¸ í•©ì˜ ë¶„ì‚°: $N\sigma^2$ â†’ $N$ì´ ì¦ê°€í•˜ë©´ <em>ì¦ê°€</em>
  </div>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ“Š</span> í‘œë³¸ í•©ì˜ ì •ê·œ ë¶„í¬ ìˆ˜ë ´</div>
  <p>CLTì— ì˜í•´ í‘œë³¸ í•©ë„ $N$ì´ ì»¤ì§ˆìˆ˜ë¡ ì •ê·œ ë¶„í¬ì— ê°€ê¹Œì›Œì§‘ë‹ˆë‹¤:</p>
  <div class="math-block">
    $$s \xrightarrow{d} \mathcal{N}\!\left(N\mu,\, \sqrt{N}\,\sigma\right)$$
  </div>
  <div class="highlight-box green">
    ì§ì ‘ ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ í™•ì¸: <a class="ch-link" href="#" onclick="loadSection('1.4.2',NAV[0],NAV[0].subs[3],NAV[0].subs[3].sections[1]);return false;">â†’ 1.4.2 í‘œë³¸ í•© ì‹œë®¬ë ˆì´ì…˜</a>
  </div>
</div>
`;

/* ---------- 1.4.2 ---------- */
CONTENT['1.4.2'] = () => String.raw`
<div class="page-title">í‘œë³¸ í•© ì‹œë®¬ë ˆì´ì…˜</div>
<div class="page-subtitle">1.4 í‘œë³¸ í•©ì˜ í™•ë¥  ë¶„í¬ â€” í•©ë„ ì •ê·œ ë¶„í¬ë¡œ ìˆ˜ë ´í•œë‹¤</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ§ª</span> ì‹¤í—˜: ê· ë“± ë¶„í¬ í‘œë³¸ì˜ í•©</div>
  <p>ê· ë“± ë¶„í¬ $\text{Uniform}(0,1)$ì—ì„œ $N$ê°œë¥¼ ë½‘ì•„ <em>í•©</em>ì„ êµ¬í•˜ëŠ” ì‹¤í—˜ì„ ë°˜ë³µí•©ë‹ˆë‹¤.</p>
  <p>ê· ë“± ë¶„í¬ì˜ $\mu = 0.5$, $\sigma^2 = 1/12$ì´ë¯€ë¡œ, í‘œë³¸ í•©ì˜ ì´ë¡  ë¶„í¬ëŠ”:</p>
  <div class="math-block">
    $$s \sim \mathcal{N}\!\left(N \cdot 0.5,\; \sqrt{N/12}\right)$$
  </div>
  <div class="interactive-panel">
    <div class="panel-header">ğŸ”¬ í‘œë³¸ í•© ì‹œë®¬ë ˆì´ì…˜</div>
    <div class="panel-body">
      <div class="chart-wrap"><canvas id="sum-chart" height="260"></canvas></div>
      <div class="controls-wrap">
        <div class="ctrl-group">
          <div class="ctrl-label">í‘œë³¸ í¬ê¸° N = <span id="sum-n-val">5</span></div>
          <input type="range" id="sum-n-slider" min="1" max="30" step="1" value="5"
            oninput="document.getElementById('sum-n-val').textContent=this.value;">
        </div>
        <button class="btn btn-green" style="width:100%;margin-bottom:10px;" onclick="runSumSim()">â–¶ ì‹¤í–‰</button>
        <div class="stat-grid" style="grid-template-columns:1fr 1fr;">
          <div class="stat-card"><div class="label">ì´ë¡  í‰ê· </div><div class="value" id="sum-theory-mu">2.50</div></div>
          <div class="stat-card"><div class="label">ì‹¤í—˜ í‰ê· </div><div class="value" id="sum-emp-mu">â€”</div></div>
          <div class="stat-card"><div class="label">ì´ë¡  Ïƒ</div><div class="value" id="sum-theory-sigma">0.645</div></div>
          <div class="stat-card"><div class="label">ì‹¤í—˜ Ïƒ</div><div class="value" id="sum-emp-sigma">â€”</div></div>
        </div>
      </div>
    </div>
  </div>
</div>
`;

/* ---------- 1.4.3 ---------- */
CONTENT['1.4.3'] = () => String.raw`
<div class="page-title">ê· ë“± ë¶„í¬ì˜ í‰ê· ê³¼ ë¶„ì‚°</div>
<div class="page-subtitle">1.4 í‘œë³¸ í•©ì˜ í™•ë¥  ë¶„í¬ â€” ê· ë“± ë¶„í¬ì˜ í†µê³„ëŸ‰ ë„ì¶œ</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ“</span> ê· ë“± ë¶„í¬ Uniform(0, 1)</div>
  <p>ê· ë“± ë¶„í¬ì˜ í™•ë¥  ë°€ë„ í•¨ìˆ˜:</p>
  <div class="math-block">
    $$p(x) = \begin{cases} 1 & 0 \le x \le 1 \\ 0 & \text{otherwise} \end{cases}$$
  </div>
</div>

<div class="section">
  <div class="section-title"><span class="icon">âš–ï¸</span> ê· ë“± ë¶„í¬ì˜ í‰ê·  ë„ì¶œ</div>
  <div class="math-block">
    $$\mu = \int_{-\infty}^{\infty} x\, p(x)\, dx = \int_{0}^{1} x \cdot 1\, dx = \left[\frac{x^2}{2}\right]_0^1 = \frac{1}{2}$$
  </div>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ“</span> ê· ë“± ë¶„í¬ì˜ ë¶„ì‚° ë„ì¶œ</div>
  <div class="math-block">
    $$\sigma^2 = \int_{0}^{1} \left(x - \frac{1}{2}\right)^2 dx
    = \int_{0}^{1} \left(x^2 - x + \frac{1}{4}\right) dx
    = \left[\frac{x^3}{3} - \frac{x^2}{2} + \frac{x}{4}\right]_0^1
    = \frac{1}{3} - \frac{1}{2} + \frac{1}{4} = \frac{1}{12}$$
  </div>
  <div class="stat-grid">
    <div class="stat-card"><div class="label">í‰ê·  Î¼</div><div class="value">1/2 = 0.5</div></div>
    <div class="stat-card"><div class="label">ë¶„ì‚° ÏƒÂ²</div><div class="value">1/12 â‰ˆ 0.083</div></div>
    <div class="stat-card"><div class="label">í‘œì¤€í¸ì°¨ Ïƒ</div><div class="value">1/âˆš12 â‰ˆ 0.289</div></div>
  </div>
  <div class="highlight-box green">
    ì´ ê°’ë“¤ì´ CLT ì‹œë®¬ë ˆì´ì…˜ì˜ ì´ë¡ ê°’ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤. <a class="ch-link" href="#" onclick="loadSection('1.3.2',NAV[0],NAV[0].subs[2],NAV[0].subs[2].sections[1]);return false;">â†’ 1.3.2 CLT ì‹œë®¬ë ˆì´ì…˜ í™•ì¸</a>
  </div>
</div>
`;

/* ---------- 1.5.1 ---------- */
CONTENT['1.5.1'] = () => String.raw`
<div class="page-title">ìš°ë¦¬ ì£¼ë³€ì˜ ì •ê·œ ë¶„í¬</div>
<div class="page-subtitle">1.5 â€” ì¤‘ì‹¬ ê·¹í•œ ì •ë¦¬ê°€ ìì—°ê³¼ ì‚¬íšŒë¥¼ ì„¤ëª…í•˜ëŠ” ë°©ì‹</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸŒ</span> ì™œ ì •ê·œ ë¶„í¬ê°€ ì–´ë””ì„œë‚˜ ë‚˜íƒ€ë‚ ê¹Œ?</div>
  <p>ì¤‘ì‹¬ ê·¹í•œ ì •ë¦¬ì— ì˜í•´, ì—¬ëŸ¬ ë…ë¦½ì ì¸ ìš”ì¸ë“¤ì˜ <em>ëˆ„ì  í•©</em>ìœ¼ë¡œ ê²°ì •ë˜ëŠ” í˜„ìƒì€ ì •ê·œ ë¶„í¬ë¥¼ ë”°ë¥´ëŠ” ê²½í–¥ì´ ìˆìŠµë‹ˆë‹¤.</p>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ”¬</span> 1. ì¸¡ì • ì˜¤ì°¨</div>
  <p>ì–´ë–¤ ê¸°êµ¬ë¡œ ê°™ì€ ëŒ€ìƒì„ ë°˜ë³µ ì¸¡ì •í•  ë•Œ ë‚˜íƒ€ë‚˜ëŠ” ì˜¤ì°¨ëŠ” ë³´í†µ ì •ê·œ ë¶„í¬ë¥¼ ë”°ë¦…ë‹ˆë‹¤.</p>
  <div class="math-block">
    $$\epsilon = \epsilon^{(1)} + \epsilon^{(2)} + \cdots + \epsilon^{(N)}$$
  </div>
  <p>ê° ì¸¡ì •ë§ˆë‹¤ í™˜ê²½, ê¸°ê¸° íŠ¹ì„±, ì¡°ì‘ ë“± ë‹¤ì–‘í•œ ë¯¸ì„¸ ìš”ì¸ì´ ë…ë¦½ì ìœ¼ë¡œ ì˜¤ì°¨ì— ì˜í–¥ì„ ì¤ë‹ˆë‹¤. ì´ í•©ì´ ì •ê·œ ë¶„í¬ì— ìˆ˜ë ´í•©ë‹ˆë‹¤.</p>
  <div class="highlight-box amber">
    ë§Œì•½ ì¸¡ì •ê°’ì´ ì •ê·œ ë¶„í¬ë¥¼ í¬ê²Œ ë²—ì–´ë‚œë‹¤ë©´ ê¸°ê¸° ê³ ì¥ì´ë‚˜ ê³„í†µ ì˜¤ì°¨ë¥¼ ì˜ì‹¬í•´ì•¼ í•©ë‹ˆë‹¤.
  </div>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ­</span> 2. ì œí’ˆ í¬ê¸°</div>
  <p>ê³µì¥ì—ì„œ ìƒì‚°ëœ 500ml ìƒìˆ˜ë³‘ì˜ ì‹¤ì œ ìš©ëŸ‰ì„ ì—¬ëŸ¬ ê°œ ì¸¡ì •í•˜ë©´, 500ml ì£¼ë³€ì˜ ì •ê·œ ë¶„í¬ë¥¼ ë”°ë¦…ë‹ˆë‹¤.</p>
  <p>ì œí’ˆì´ ì™„ì„±ë˜ê¸°ê¹Œì§€ ì—¬ëŸ¬ ê³µì •ë§ˆë‹¤ ë¯¸ì„¸í•œ ì˜¤ì°¨ê°€ ëˆ„ì ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ§‘</span> 3. ì‚¬ëŒì˜ í‚¤</div>
  <p>ê°™ì€ ë‚˜ì´Â·ì„±ë³„ì˜ ì‚¬ëŒë“¤ í‚¤ëŠ” ì •ê·œ ë¶„í¬ì— ê·¼ì‚¬í•©ë‹ˆë‹¤. ìœ ì „, ì‹ìŠµê´€, ìš´ë™, í™˜ê²½ ë“± ë‹¤ì–‘í•œ ë…ë¦½ì  ìš”ì¸ì˜ ë³µí•© ì‘ìš©ìœ¼ë¡œ ì„¤ëª…ë©ë‹ˆë‹¤.</p>
  <div class="stat-grid">
    <div class="stat-card"><div class="label">í•œêµ­ ì„±ì¸ ë‚¨ì„± í‰ê·  í‚¤</div><div class="value">â‰ˆ 174cm</div></div>
    <div class="stat-card"><div class="label">í‘œì¤€í¸ì°¨</div><div class="value">â‰ˆ 6cm</div></div>
    <div class="stat-card"><div class="label">160~188cm í™•ë¥ </div><div class="value">â‰ˆ 95.4%</div></div>
  </div>
</div>

<div class="section">
  <div class="section-title"><span class="icon">ğŸ”—</span> ë‹¤ìŒ ë‹¨ê³„ë¡œ</div>
  <p>ì •ê·œ ë¶„í¬ë¥¼ ì‹¤ì œ ë°ì´í„°ì— ì í•©(fitting)ì‹œí‚¤ë ¤ë©´ ë§¤ê°œë³€ìˆ˜ $\mu$, $\sigma$ë¥¼ ì¶”ì •í•´ì•¼ í•©ë‹ˆë‹¤. ì´ê²ƒì´ ë‹¤ìŒ ì±•í„°ì˜ ì£¼ì œì…ë‹ˆë‹¤.</p>
  <div class="highlight-box purple">
    <a class="ch-link" href="#" onclick="alert('Chapter 2 ìµœëŒ€ ê°€ëŠ¥ë„ ì¶”ì •ì€ ì¤€ë¹„ì¤‘ì…ë‹ˆë‹¤.')">â†’ Chapter 2 ìµœëŒ€ ê°€ëŠ¥ë„ ì¶”ì •(MLE) í•™ìŠµí•˜ê¸°</a>
  </div>
</div>
`;

/* ============================================================
   CHART IMPLEMENTATIONS
   ============================================================ */

/* --- 1.1.1 Dice --- */
let diceFreq = [0,0,0,0,0,0];
let diceTotal = 0;
let diceChartInst = null;

function init_dice() {
  const faces = ['âš€','âš','âš‚','âšƒ','âš„','âš…'];
  const ctx = document.getElementById('dice-chart');
  if (!ctx) return;
  diceFreq = [0,0,0,0,0,0]; diceTotal = 0;
  diceChartInst = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ['1','2','3','4','5','6'],
      datasets: [
        { label: 'ê´€ì¸¡ ë¹ˆë„', data: [0,0,0,0,0,0], backgroundColor: 'rgba(59,130,246,0.6)', borderColor: '#3b82f6', borderWidth: 1 },
        { label: 'ì´ë¡ ê°’ (1/6)', data: [1/6,1/6,1/6,1/6,1/6,1/6], type:'line', borderColor:'#ef4444', borderDash:[5,5], pointRadius:0, borderWidth:2, fill:false }
      ]
    },
    options: {
      responsive:true, plugins:{ legend:{position:'top'} },
      scales:{ y:{ title:{display:true,text:'ìƒëŒ€ ë¹ˆë„'}, min:0, max:0.5 } }
    }
  });
  activeChartInstances['dice'] = diceChartInst;
}

window.rollDice = function(n) {
  for (let i = 0; i < n; i++) {
    const r = Math.floor(Math.random() * 6);
    diceFreq[r]++;
    diceTotal++;
  }
  document.getElementById('dice-count').textContent = diceTotal;
  const lastRoll = Math.floor(Math.random() * 6) + 1;
  const face = document.getElementById('die-face');
  if (face) { face.classList.remove('rolling'); void face.offsetWidth; face.classList.add('rolling'); face.textContent = lastRoll; }
  if (diceChartInst) {
    const rel = diceFreq.map(f => diceTotal > 0 ? f/diceTotal : 0);
    diceChartInst.data.datasets[0].data = rel;
    diceChartInst.update();
  }
};
window.resetDice = function() {
  diceFreq = [0,0,0,0,0,0]; diceTotal = 0;
  document.getElementById('dice-count').textContent = 0;
  if (diceChartInst) { diceChartInst.data.datasets[0].data = [0,0,0,0,0,0]; diceChartInst.update(); }
};

/* --- 1.2.2 Normal basic with area --- */
let normalBasicChart = null;

function init_normal_basic() {
  const ctx = document.getElementById('normal-basic-chart');
  if (!ctx) return;
  const xs = linspace(-4, 4, 200);
  const ys = xs.map(x => normalPDF(x, 0, 1));

  normalBasicChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: xs.map(x => x.toFixed(2)),
      datasets: [
        { label: 'N(0,1)', data: ys, borderColor: '#3b82f6', borderWidth: 2.5, fill: false, pointRadius: 0, tension: 0.4 },
        { label: 'ì„ íƒ êµ¬ê°„', data: new Array(200).fill(null), backgroundColor: 'rgba(59,130,246,0.25)', borderWidth: 0, fill: true, pointRadius: 0 }
      ]
    },
    options: { responsive:true, plugins:{ legend:{position:'top'} }, scales:{ y:{ min:0, max:0.45, title:{display:true,text:'p(x)'} }, x:{ title:{display:true,text:'x'}, ticks:{ maxTicksLimit:9, callback:(v,i) => parseFloat(xs[i]).toFixed(1) } } } }
  });
  activeChartInstances['normalBasic'] = normalBasicChart;
  updateNormalBasic();
}

window.updateNormalBasic = function() {
  if (!normalBasicChart) return;
  const a = parseFloat(document.getElementById('a-slider').value);
  const b = parseFloat(document.getElementById('b-slider').value);
  const xs = linspace(-4, 4, 200);
  const areaData = xs.map(x => (x >= Math.min(a,b) && x <= Math.max(a,b)) ? normalPDF(x,0,1) : null);
  normalBasicChart.data.datasets[1].data = areaData;
  normalBasicChart.update();

  // numerical integration (trapezoidal)
  const prob = numericalIntegral(Math.min(a,b), Math.max(a,b), x => normalPDF(x,0,1), 500);
  document.getElementById('prob-value').textContent = (prob * 100).toFixed(1) + '%';
};

/* --- 1.2.3 Param explorer --- */
let paramChart = null;

function init_param_explorer() {
  const ctx = document.getElementById('param-chart');
  if (!ctx) return;
  const xs = linspace(-8, 8, 300);

  paramChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: xs.map(x => x.toFixed(2)),
      datasets: [
        { label: 'í˜„ì¬ ë¶„í¬', data: xs.map(x => normalPDF(x,0,1)), borderColor: '#3b82f6', borderWidth: 2.5, fill: false, pointRadius: 0, tension: 0.4 },
        { label: 'N(0,1) ê¸°ì¤€', data: xs.map(x => normalPDF(x,0,1)), borderColor: '#94a3b8', borderWidth: 1.5, borderDash: [5,4], fill: false, pointRadius: 0, tension: 0.4 }
      ]
    },
    options: {
      responsive: true,
      plugins: { legend: { position: 'top' } },
      scales: {
        y: { min: 0, max: 2.1, title: { display: true, text: 'p(x)' } },
        x: { title: { display: true, text: 'x' }, ticks: { maxTicksLimit: 9, callback: (v,i,ticks) => { const xs2=linspace(-8,8,300); return xs2[i]!==undefined?parseFloat(xs2[i]).toFixed(1):''; } } }
      }
    }
  });
  activeChartInstances['param'] = paramChart;
}

window.updateParamChart = function() {
  if (!paramChart) return;
  const mu = parseFloat(document.getElementById('mu-slider').value);
  const sigma = parseFloat(document.getElementById('sigma-slider').value);
  const showRef = document.getElementById('show-ref').checked;
  document.getElementById('mu-badge').textContent = mu.toFixed(1);
  document.getElementById('sigma-badge').textContent = sigma.toFixed(1);
  document.getElementById('mu-val').textContent = mu.toFixed(1);
  document.getElementById('sigma-val').textContent = sigma.toFixed(1);
  const xs = linspace(-8, 8, 300);
  paramChart.data.datasets[0].data = xs.map(x => normalPDF(x, mu, sigma));
  paramChart.data.datasets[1].hidden = !showRef;
  const peak = normalPDF(mu, mu, sigma);
  document.getElementById('peak-val').textContent = peak.toFixed(3);
  document.getElementById('var-val').textContent = (sigma*sigma).toFixed(2);
  paramChart.options.scales.y.max = Math.max(2.1, peak * 1.2);
  paramChart.update();
};

/* --- 1.3.2 CLT Simulation --- */
let cltChart = null;

function init_clt_sim() {
  const ctx = document.getElementById('clt-chart');
  if (!ctx) return;
  cltChart = new Chart(ctx, {
    type: 'bar',
    data: { labels: [], datasets: [
      { label: 'í‘œë³¸ í‰ê·  íˆìŠ¤í† ê·¸ë¨', data: [], backgroundColor: 'rgba(59,130,246,0.5)', borderColor:'#3b82f6', borderWidth:1 },
      { label: 'ì´ë¡  ì •ê·œ ë¶„í¬', data: [], type: 'line', borderColor: '#ef4444', borderWidth: 2, pointRadius: 0, fill: false }
    ]},
    options: { responsive: true, plugins: { legend: { position: 'top' } },
      scales: { y: { title: { display: true, text: 'ë¹ˆë„ (ë°€ë„)' } }, x: { title: { display: true, text: 'í‘œë³¸ í‰ê· ' }, ticks: { maxTicksLimit: 10 } } }
    }
  });
  activeChartInstances['clt'] = cltChart;
}

window.runCLT = function() {
  if (!cltChart) return;
  const N = parseInt(document.getElementById('clt-n-slider').value);
  const trials = parseInt(document.getElementById('clt-trials').value);
  const mu_theory = 0.5, sigma_theory = Math.sqrt(1/12/N);

  const means = [];
  for (let t = 0; t < trials; t++) {
    let s = 0;
    for (let i = 0; i < N; i++) s += Math.random();
    means.push(s / N);
  }

  const minV = Math.min(...means), maxV = Math.max(...means);
  const bins = 40;
  const binSize = (maxV - minV) / bins || 0.01;
  const freq = new Array(bins).fill(0);
  means.forEach(v => {
    const idx = Math.min(Math.floor((v - minV) / binSize), bins - 1);
    freq[idx]++;
  });
  const density = freq.map(f => f / (trials * binSize));
  const labels = Array.from({length: bins}, (_, i) => (minV + (i + 0.5) * binSize).toFixed(3));

  // normal overlay
  const normY = labels.map(x => normalPDF(parseFloat(x), mu_theory + 0.5 - 0.5, sigma_theory));

  cltChart.data.labels = labels;
  cltChart.data.datasets[0].data = density;
  cltChart.data.datasets[1].data = normY;
  cltChart.update();

  // empirical stats
  const empMu = means.reduce((a,b)=>a+b,0)/means.length;
  const empVar = means.reduce((a,b)=>a+(b-empMu)**2,0)/means.length;
  document.getElementById('clt-theory-mu').textContent = mu_theory.toFixed(3);
  document.getElementById('clt-emp-mu').textContent = empMu.toFixed(3);
  document.getElementById('clt-theory-sigma').textContent = sigma_theory.toFixed(3);
  document.getElementById('clt-emp-sigma').textContent = Math.sqrt(empVar).toFixed(3);
};

/* --- 1.4.2 Sum Simulation --- */
let sumChart = null;

function init_sum_sim() {
  const ctx = document.getElementById('sum-chart');
  if (!ctx) return;
  sumChart = new Chart(ctx, {
    type: 'bar',
    data: { labels: [], datasets: [
      { label: 'í‘œë³¸ í•© íˆìŠ¤í† ê·¸ë¨', data: [], backgroundColor: 'rgba(34,197,94,0.5)', borderColor:'#22c55e', borderWidth:1 },
      { label: 'ì´ë¡  ì •ê·œ ë¶„í¬', data: [], type: 'line', borderColor: '#ef4444', borderWidth: 2, pointRadius: 0, fill: false }
    ]},
    options: { responsive: true, plugins: { legend: { position: 'top' } },
      scales: { y: { title: { display: true, text: 'ë¹ˆë„ (ë°€ë„)' } }, x: { title: { display: true, text: 'í‘œë³¸ í•©' }, ticks: { maxTicksLimit: 10 } } }
    }
  });
  activeChartInstances['sum'] = sumChart;
}

window.runSumSim = function() {
  if (!sumChart) return;
  const N = parseInt(document.getElementById('sum-n-slider').value);
  const trials = 5000;
  const mu_s = N * 0.5, sigma_s = Math.sqrt(N / 12);

  const sums = [];
  for (let t = 0; t < trials; t++) {
    let s = 0;
    for (let i = 0; i < N; i++) s += Math.random();
    sums.push(s);
  }

  const minV = Math.min(...sums), maxV = Math.max(...sums);
  const bins = 40;
  const binSize = (maxV - minV) / bins || 0.01;
  const freq = new Array(bins).fill(0);
  sums.forEach(v => {
    const idx = Math.min(Math.floor((v - minV) / binSize), bins - 1);
    freq[idx]++;
  });
  const density = freq.map(f => f / (trials * binSize));
  const labels = Array.from({length: bins}, (_, i) => (minV + (i + 0.5) * binSize).toFixed(2));

  const normY = labels.map(x => normalPDF(parseFloat(x), mu_s, sigma_s));

  sumChart.data.labels = labels;
  sumChart.data.datasets[0].data = density;
  sumChart.data.datasets[1].data = normY;
  sumChart.update();

  const empMu = sums.reduce((a,b)=>a+b,0)/sums.length;
  const empVar = sums.reduce((a,b)=>a+(b-empMu)**2,0)/sums.length;
  document.getElementById('sum-theory-mu').textContent = mu_s.toFixed(3);
  document.getElementById('sum-emp-mu').textContent = empMu.toFixed(3);
  document.getElementById('sum-theory-sigma').textContent = sigma_s.toFixed(3);
  document.getElementById('sum-emp-sigma').textContent = Math.sqrt(empVar).toFixed(3);

  document.getElementById('sum-n-val').textContent = N;
};

/* ============================================================
   UTILITIES
   ============================================================ */
function numericalIntegral(a, b, f, n=200) {
  if (a >= b) return 0;
  const h = (b - a) / n;
  let sum = (f(a) + f(b)) / 2;
  for (let i = 1; i < n; i++) sum += f(a + i * h);
  return sum * h;
}

</script>
</body>
</html>
